<div class="section" id="index-banner">
<div class="container">
        <div class="row" style="margin-bottom: 0;">
          <!--<div class="col s12 m12 l12offset-m1 xl7 offset-xl1 center-on-small-only">-->
              <div class="col s12">
                  <h2 class="">Obtenir les données</h2>
            <p>Cette page documente les différents moyens à disposition des bibliothèques membres du CR PACA/Nice pour récupérer leurs lots de données</p>
            <p><i><b>Source des données</b> : Agence bibliographique de l'Enseignement supérieur, BnF</i></p>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
            <div class="col s12">
              <ul class="tabs">
                <li class="tab col s3" ng-click="currentTab = 'api'"><a ng-class="{'active':currentTab == 'api'}" href="">API</a></li>
                <li class="tab col s3"ng-click="currentTab = 'excel'"><a ng-class="{'active':currentTab == 'excel'}" href="">Exports Excel</a></li>
                <li class="tab col s3"ng-click="currentTab = 'widget'"><a ng-class="{'active':currentTab == 'widget'}" href="">Widget dans une page web</a></li>
              </ul>
            </div>
          </div>
<!--API Tab-->
    <div class="container" ng-show="currentTab == 'api'">    
<div class="row">    
    <div class="section col s12">
      <div id="download" class="section scrollspy">
        <div class="row">
          <div class="col s12">
            <h4 class="">API</h4>
            <p class="caption">Une API est une <i>Interface de programmation applicative</i> qui permet à un logiciel ou une application de redistribuer ses données dans un format structuré (ici du Json). Elle n'est pas destinée à être interprétée par des humains mais à être intégrée informatiquement par des programmes tiers</p>
            <p class="caption">La modélisation de type graphe sous-jacente à cette application permet de ré-exposer différemment une partie des métadonnées de l'Abes et de la BnF : des sous-corpus de donnnées spécifiques aux périodiques du CR PACA/Nice bénéficiant des alignements (appariements) effectués dynamiquement dans la base de données.</p>
            <p class="caption"><i>Cette API ne donne pas accès à l'ensemble des méthodes CRUD usuelles, elle expose seulement les données en lecture avec la méthode GET</i></p>
            <p> <a id="download-source" class="btn waves-effect waves-light" href="http://localhost:3000/api-docs" target="_blanck">Pour les développeurs : documentation swagger<i class="material-icons right">file_download</i></a></p>  
        </div>
        <div class="col s12">
            <h4 class="">Url racine</h4>
          <p>http://sudocps.univ-cotedazur.fr/sudocps-pro-app</p>
        </div>
        <hr>
          <div class="col s12">
              <h4 class="">Les unicas du CR</h4>
            <p>La requête renvoie l'ensemble des notices d'unicas du CR PACA/Nice comprenant les éléments suivants : éléments de titre, identifiants (ppn, issn, ark), bibliothèque possédant le périodique, état de collection dans le Sudoc. </p>
            <div class="row section">
                    <div class="col s12 m3"><b>Syntaxe de la requête</b></div>
                    <div class="col s12 m6">/api/unicas</div>
                    <div class="col s12 m3">
                            <a id="download-source" class="btn waves-effect waves-light" href="http://localhost:3000/api/unicas" target="_blanck">Voir<i class="material-icons right">file_download</i></a>
                    </div>
            </div>
            <div class="row section">
                    <div class="col s12 m3"><b>Structures de données</b></div>
                    <div class="col s12 m9"><pre><code>
 {unicas : 
   [{ record : {
                 degre: { // nombre de liens entrants et sortants du noeud dans le graphe
                    low : 
                    high : 
                        },
                  issn : ISSN (zone unimarc 200$a),
                  type : groupe de noeuds dans le graphe,
                  titre : titre du périodique (zone Unimarc 200$a),
                  initId : identifiant du noeud dans le graphe,
                  ppn : identifiant de la notice dans le Sudoc
                },
      loc : [{
              rcr : numéro RCR dans le répertoire des centres de ressources,
              initId : identifiant du noeud bibliothèque dans le graphe,
              latitude : latitude,
              name : équivalement shrortname de la notice RCR du Sudoc,
              degre : { //degré du noeud bibliothèque dans le graphe
                  low : ,
                  high : 
                      },
              type : groupe de noeuds dans le graphe (ici Bibliothèques),
              longitude : longitude,
              etat_de_collection : zone 955$r de l'exemplaire dans la notice Unimarc du Sudoc 
             }],
      ark_bnf : identifiant ark du périodique dans les application BnF,
      url_presselocale : url profonde sur la notice dans http://presselocaleancienne.bnf.fr
      numerisation : [{
              degre { //degré du noeud bibliothèque dans le graphe
                   low : ,
                   high : 
                    },
              type : groupe de noeuds dans le graphe (ici Numérisation), 
              url : lien vers la nuimérisation,
              initId : identifiant du noeud Numeriastion dans le graphe,
              lieu : établissement ayany effectué la numérisation
                     }]
  }]
 }                                 
                    </code></pre></div>
            </div>

          </div>
          <hr>
          <div class="col s12">
              <h4 class="">Les unicas par RCR</h4>
            <p>La requête prend en paramètre le numéro RCR d'une bibliothèque et renvoie la liste de ses unicas avec les mêmes données que celles renvoyées par la requête globale cu-dessus</p>
            <div class="row section">
                    <div class="col s12 m3"><b>Syntaxe de la requête</b></div>
                    <div class="col s12 m6">/api/rcr2unicas/{rcr}</div>
                    <div class="col s12 m3">
                            <a id="download-source" class="btn waves-effect waves-light" href="http://localhost:3000/api/rcr2unicas/060885105" target="_blanck">Voir pour le rcr 060885105<i class="material-icons right">file_download</i></a>
                    </div>
            </div> 
            <div class="row section">
                    <div class="col s12 m3"><b>Formatage des résultats</b></div>
                    <div class="col s12 m9"><pre><code>
 { 
    query : 
             {
            rcr : numéro RCR passé en paramètre dans l'url
             },
    unicas : [{
             ... cf ci-dessus ...
             }] 
 }                                 
                    </code></pre></div>
            </div>
        </div>
 
        </div>
        <div class="row">
            <div class="col s12">
                <h4 class="">Les titres de presse locale ancienne</h4>
                <p>La requête renvoie l'ensemble des notices de presse locale ancienne du CR PACA/Nice (couvrant les 2 départements des Alpes-Maritimes et du Var, et de la Principauté de Monaco). Elles sont constituées de métdonnées suivantes : titre, identifiants (ppn, issn, ark), bibliothèque possédant le périodique, état de collection dans le Sudoc. </p>
                <div class="row section">
                        <div class="col s12 m3"><b>Syntaxe de la requête</b></div>
                        <div class="col s12 m6">/api/presselocale</div>
                        <div class="col s12 m3">
                                <a id="download-source" class="btn waves-effect waves-light" href="http://localhost:3000/api/presselocale" target="_blanck">Voir<i class="material-icons right">file_download</i></a>
                        </div>
                </div>
                <div class="row section">
                    <div class="col s12 m3"><b>Structure des données</b></div>
                    <div class="col s12 m9"><pre><code>
 {presselocale : 
   [{ record : {
         degre: { // nombre de liens entrants et sortants du noeud dans le graphe
            low : 
            high : 
                },
         ark : identifiant ark du périodique dans les application BnF,      
         issn : ISSN,
         type : groupe de noeuds dans le graphe (ici Presse locale),
         titre : titre du périodique,
         initId : idientifiant du noeud dans le graphe
                },
      depts_about : [{ // départements concernés
          name : nom,
          number : numéro administratif (06,83,99),
          degre : { //degré du noeud bibliothèque dans le graphe
            low : ,
            high : 
                  },
          type : groupe de noeuds dans le graphe (ici Départements),
          initId : identifiant du noeud bibliothèque dans le graphe
                   }],
      sudoc_record : {
         degre: { // nombre de liens entrants et sortants du noeud dans le graphe
            low : 
            high : 
                },
        issn : ISSN,
        type : groupe de noeuds dans le graphe,
        titre : titre du périodique,
        initId : identifiant du noeud dans le graphe,
        ppn : identifiant de la notice dans le Sudoc
             }    
      sudoc_locs : [{ // localisations dans le Sudoc pour le CR
        rcr : numéro RCR dans le répertoire des centres de ressources,
        initId : identifiant du noeud bibliothèque dans le graphe,
        latitude : latitude,
        name : équivalement shrortname de la notice RCR du Sudoc,
        degre : { //degré du noeud bibliothèque dans le graphe
            low : ,
            high : 
                },
        type : groupe de noeuds dans le graphe (ici Bibliothèques),
        longitude : longitude
             }],          
      numrisation : [{
        degre { //degré du noeud bibliothèque dans le graphe
          low : ,
          high : 
              },
          type : groupe de noeuds dans le graphe (ici Numérisation), 
          url : lien vers la nuimérisation,
          initId : identifiant du noeud Numeriastion dans le graphe,
          lieu : établissement ayany effectué la numérisation
                     }]
   }]
 }                                 
                    </code></pre></div>
            </div>
                </div>
                <div class="col s12">
                    <h4 class="">La presse locale ancienne par RCR</h4>
                  <p>La requête prend en paramètre le numéro RCR d'une bibliothèque et renvoie la liste des titres de presse locale ancienne qu'elle conserve avec les mêmes données que celles renvoyées par la requête globale cu-dessus</p>
                  <div class="row section">
                          <div class="col s12 m3"><b>Syntaxe de la requête</b></div>
                          <div class="col s12 m6">/api/rcr2presselocale/{rcr}</div>
                          <div class="col s12 m3">
                                  <a id="download-source" class="btn waves-effect waves-light" href="http://localhost:3000/api/rcr2presselocale/060885105" target="_blanck">Voir pour le rcr 060885105<i class="material-icons right">file_download</i></a>
                          </div>
                  </div> 
                  <div class="row section">
                          <div class="col s12 m3"><b>Formatage des résultats</b></div>
                          <div class="col s12 m9"><pre><code>
       { 
          query : 
                   {
                  rcr : numéro RCR passé en paramètre dans l'url
                   },
          presselocale : [{
                   ... cf ci-dessus ...
                   }] 
       }                                 
                          </code></pre></div>
                  </div>
              </div>    
        </div>
      </div>
  </div>
 </div>
 </div>
 <!--end API Tab-->
 <!--Excel Tab-->
 <div class="container" ng-show="currentTab == 'excel'">
        <div id="setup" class="row scrollspy">
                <div class="col s12">
                  <h4 class="">Exports Excel</h4>
                  <p class="caption ">La modélisation de type graphe sous-jacente à cette application permet de ré-exposer différemment une partie des métadonnées de l'Abes et de la BnF. 
                    En effet, les sous-corpus de donnnées spécifiques aux périodiques du CR PACA/Nice bénéficient des alignements (appariements) effectués dynamiquement dans la base de données entre les métadonnées issues du Sudoc et celles provenant de la BnF via le site Presse locale ancienne. 
                    Les données exportables en Excel mêlent donc les deux niveaux d'information : les exports ayant pour point d'entrée les unicas dans le Sudoc contiennent aussi les métadonnées de la BnF pour les titres concernés (alignés), et réciproquement pour les exports portant sur le corpus de Presse locale ancienne.</p>
                  <div class="col s12">
                        <div class="row section">
                            <div class="col s12 m6">
                                <h4 class="">Les unicas</h4>
                              <div class="col s12">
                                  <h6><b>Export de l'ensemble des unicas du CR</b></h6>
                                  <p><button class="btn waves-effect waves-light" ng-click="unicasExportAll()">Download<i class="material-icons right">file_download</i></button></p>
                              </div> 
                                <div class="col s12">
                                        <h6><b>Export des lots d'unicas par bibliothèques</b></h6>
                                        <div class="input-field col s12">
                                                <select class="browser-default" ng-model="bibSelectForUnicas">
                                                  <option value="" disabled>Choisir une bibliothèque</option>
                                                  <option ng-repeat="bib in bibs" value="{{bib.library.rcr}}">{{bib.library.shortname}}</option>
                                                </select>
                                              </div>
                                        <button class="btn waves-effect waves-light" ng-click="unicasExport(bibSelectForUnicas)">Download<i class="material-icons right">file_download</i></button>
                                </div>
                            </div>
                                <div class="col s12 m6">
                                    <h4 class="">La presse locale ancienne</h4>
                                    <div class="col s12">
                                        <h6><b>Export de l'ensemble des titres de presse locale ancienne du CR</b></h6>
                                        <p><button class="btn waves-effect waves-light" ng-click="presseExportAll()">Download<i class="material-icons right">file_download</i></button></p>
                                    </div> 
                                        <h6><b>Export des lots de titres de presse locale ancienne par bibliothèque</b></h6>
                                        <div class="input-field col s12">
                                          <select class="browser-default" ng-model="bibSelectForPresse">
                                            <option value="" disabled>Choisir une bibliothèque</option>
                                            <option ng-repeat="bib in bibs" value="{{bib.library.rcr}}">{{bib.library.shortname}}</option>
                                          </select>
                                        </div>
                                  <button class="btn waves-effect waves-light" ng-click="presseExport(bibSelectForPresse)">Download<i class="material-icons right">file_download</i></button>
                                </div>
                        </div> 
                    </div>
                </div>       
              </div>
 </div>
 <!--end excel tab-->
 <!--widget tab-->
 <div class="container" ng-show="currentTab == 'widget'">
        <div id="setup" class="row scrollspy">
                <div class="col s12">
                  <h4 class="">Intégration de widget</h4>
                  <p class="caption ">Les widgets web sont des portions de code prêtes à l'emploi pour être insérées dans une page web pré-existante. Ce sont donc des blocs de contenus embarqués dans un site, mais indépendants et délivrant du contenu provenant d'un autre serveur.</p>
                  <p class="caption">Grâce à l'API fournie avec cette application, nous pouvons proposer aux bibliothèques qui le souhaitent un script leur permettant d'afficher, par exemple, la liste de leurs unicas sur leur site.</p>  
                  <p class="caption">Pour cela, il suffit d'insérer dans le code HTML de la page web qui affichera le widget :</p>
                  <ol>
                    <li>A l'endroit de la page où apparaitra le widget 
                      <xmp>
                        <div id="widget"></div>
                      </xmp>
                    </li>
                    <li>En fin de page avant la balise fermante body 
                      <xmp>
                        <script id="sudocps-unicabyrcr" src="http://sudocps.univ-cotedazur.fr/sudocps-pro-app/widget" rcr="<numero_rcr>"></script>
                      </xmp>
                    </li>
                  </ol> 
                  <div class="row">    
                      <div class="input-field col s6">
                          <input id="last_name" type="text" ng-model="rcr" class="validate">
                          <label for="last_name">Par exemple pour le RCR</label>
                        </div>
                        <div class="col s6">
                            <button class="btn-small cyan waves-effect waves-light" ng-click="reloadJS()">Go
                                <i class="material-icons right">send</i>
                              </button>
                        </div>
                      </div>
                      <div class="row" id="widgetScript">
                        <p>{{rcr}}</p>
                    <div id="widget"></div>
                    <!--<script id="sudocps-unicabyrcr" src="http://sudocps.univ-cotedazur.fr/sudocps-pro-app/widget" rcr="{{rcr}}"></script>-->
                    <script id="sudocps-unicabyrcr" src="./widget" rcr="{{rcr}}"></script>
                    </div>
                </div>
                  </div>
 </div>
 <!-- end widget tab-->